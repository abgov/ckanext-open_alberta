{% ckan_extends %}

{% block search_title %}
{% endblock %}

{% block search_input %}
  <div class="row">
    {% block search_input_button %}{% endblock %}
    {% if not no_title %}
        <div class="col-xs-12"><h2>{% snippet 'snippets/search_result_text.html', query=query, count=count, type=type %}</h2></div>
    {% endif %}
    {% if sorting %}
      {% if count != 0 %}
        <div class="col-xs-12">
            <a class="btn btn-primary filter-toggle" href="#" onclick="toggleFilters()">Filters</a>
            <div class="row">
                <div class="col-md-6">
                    <div class="resources-order-by">
                        <label for="field-order-by" class="expand">{{ _('Sort Results by') }}</label>
                        <select id="field-order-by" class="form-control wd-80" name="sort">
                    {% for label, value in sorting %}
                        {% if label and value %}
                            <option value="{{ value }}"{% if sorting_selected == value %} selected="selected"{% endif %}>{{ label }}</option>
                        {% endif %}
                    {% endfor %}
                        </select>
                    </div>
                </div><div class="col-md-6">
                    <div class="resources-page-size">
                        <label for="field-pagesize" class="expand">{{ _('Items per page') }}</label>
                        <select id="field-pagesize" class="form-control">
                        {% for opt in h.config_datasets_per_pg_options() %}
                            <option>{{ opt }}</option>
                        {% endfor %}
                        </select>
                    </div>
                </div>
            </div>
        </div>
		{% resource 'open_alberta/js/paging.js' %}
      {% else %}
        <div class="col-xs-12">
            <p>Didnâ€™t find what you were looking for? Help us expand our portal and <a target="_blank" href="{{ h.url_for('/suggest') }}">suggest a resource</a>.</p>
        </div>
      {% endif %}
    {% endif %}
    {% if facets %}
        <div class="col-xs-12">
            <p class="filter-list"><strong>FILTERS:</strong> {% if facets.fields|length == 0 %}<span>None selected</span>{% endif %}<br/>
        {% for field in facets.fields %}
            {% set search_facets_items = facets.search.get(field)['items'] %}
                <span class="facet">{{ facets.titles.get(field) }}:</span>
            {% for value in facets.fields[field] %}
                <span class="filtered badge">
                {%- if facets.translated_fields and facets.translated_fields.has_key((field,value)) -%}
                    {{ facets.translated_fields[(field,value)] }}
                {%- else -%}
                    {{ h.list_dict_filter(search_facets_items, 'name', 'display_name', value) }}
                {%- endif %}
                    <a href="{{ facets.remove_field(field, value) }}" class="remove" title="{{ _('Remove') }}"><i class="icon-remove"></i></a>
                </span>
            {% endfor %}
            <br/>
        {% endfor %}
            </p>
        </div>
    {% endif %}
  </div>
{% endblock %}

{% block search_facets %}{% endblock %}
{% block search_sortby %}{% endblock %}

{% if show_empty and count == 0 %}
    <p class="extra">Please try another search........</p>
{% endif %}
